# Send a reminder when garbage collection is tomorrow
- id: '0803'
  alias: Reminder - Garbage Collection
  triggers:
    - trigger: time
      at: '08:00:00'
    - trigger: time
      at: '20:00:00'
  conditions:
    condition: template
    value_template: >
      {% set next_date = state_attr('binary_sensor.garbage_collection', 'next_date') %}
      {% if next_date and next_date != 'None' %}
        {% set today = now().date() %}
        {% set collection_date = strptime(next_date, '%Y-%m-%d').date() %}
        {% set days = (collection_date - today).days %}
        {{ days == 1 }}
      {% else %}
        false
      {% endif %}
  actions:
    action: notify.home_mobile_apps
    data:
      title: 'HalloNET Home'
      message: "Collection of {{ state_attr('binary_sensor.garbage_collection', 'friendly_message') }}."
      data:
        channel: Reminder

# Turn on outdoor lights at sunset
- id: '0401'
  alias: Lighting - Turn on outdoor lights at sunset
  trigger:
    platform: sun
    event: sunset
  action:
    service: homeassistant.turn_on
    entity_id: group.outdoor_comfort_lights

# Turn on lights when living room becomes dark and someone is home (or vacation mode is on)
- id: '0402'
  alias: Lighting - Turn on comfort lights when dark
  trigger:
    platform: numeric_state
    entity_id: sensor.living_room_light_level
    below: 7
    for:
      seconds: 60
  condition:
    condition: and
    conditions:
      - condition: time
        after: '12:00'
      - condition: sun
        before: sunset
      - condition: state
        entity_id: input_boolean.night_mode
        state: 'off'
      - condition: or
        conditions:
          - condition: state
            entity_id: alarm_control_panel.snyggatorpsvagen_alarm
            state: disarmed
          - condition: state
            entity_id: input_boolean.vacation_mode
            state: 'on'
  action:
    service: homeassistant.turn_on
    entity_id:
      - scene.living_room_lights_normal
      - scene.dining_room_lights_normal
      - scene.kitchen_lights_normal
      - scene.upstairs_lights_normal

# Turn on Lovelia's lights when living room becomes dark, someone is home (or vacation mode is on), and Lovelia is not asleep
- id: '0403'
  alias: Lighting - Turn on Lovelias comfort lights when dark
  trigger:
    platform: numeric_state
    entity_id: sensor.living_room_light_level
    below: 7
    for:
      seconds: 60
  condition:
    condition: and
    conditions:
      - condition: time
        after: '12:00'
      - condition: sun
        before: sunset
      - condition: time
        before: '19:00:00'
      - condition: state
        entity_id: input_boolean.night_mode
        state: 'off'
      - condition: or
        conditions:
          - condition: state
            entity_id: alarm_control_panel.snyggatorpsvagen_alarm
            state: disarmed
          - condition: state
            entity_id: input_boolean.vacation_mode
            state: 'on'
  action:
    service: homeassistant.turn_on
    entity_id: scene.lovelias_room_lights_normal

# Turn on bedroom lights when living room becomes dark, someone is home (or vacation mode is on), and automation is not blocked
- id: '0404'
  alias: Lighting - Turn on bedroom comfort lights when dark
  trigger:
    platform: numeric_state
    entity_id: sensor.living_room_light_level
    below: 7
    for:
      seconds: 60
  condition:
    condition: and
    conditions:
      - condition: time
        after: '12:00'
      - condition: sun
        before: sunset
      - condition: state
        entity_id: input_boolean.bedroom_block_light_automation
        state: 'off'
      - condition: state
        entity_id: input_boolean.night_mode
        state: 'off'
      - condition: or
        conditions:
        - condition: state
          entity_id: alarm_control_panel.snyggatorpsvagen_alarm
          state: disarmed
        - condition: state
          entity_id: input_boolean.vacation_mode
          state: 'on'
  action:
    service: homeassistant.turn_on
    entity_id: scene.bedroom_lights_normal

# Turn on window lights when living room becomes dark and no one's home
- id: '0405'
  alias: Lighting - Turn on window lights when dark
  trigger:
    platform: numeric_state
    entity_id: sensor.living_room_light_level
    below: 7
    for:
      seconds: 60
  condition:
    condition: and
    conditions:
      - condition: time
        after: '12:00'
      - condition: sun
        before: sunset
      - condition: state
        entity_id: input_boolean.night_mode
        state: 'off'
      - condition: state
        entity_id: alarm_control_panel.snyggatorpsvagen_alarm
        state: armed_away
  action:
    service: homeassistant.turn_on
    entity_id: indoor_window_lights

# Turn off outdoor lights at sunrise
- id: '0408'
  alias: Lighting - Turn off outdoor lights at sunrise
  trigger:
    platform: sun
    event: sunrise
  action:
    service: homeassistant.turn_off
    entity_id: group.outdoor_comfort_lights

# Turn off indoor lights when living room is bright
- id: '0409'
  alias: Lighting - Turn off indoor lights when bright
  trigger:
    platform: numeric_state
    entity_id: sensor.living_room_light_level
    above: 9
    for:
      minutes: 5
  condition:
    condition: sun
    after: sunrise
    before: sunset
  action:
    service: homeassistant.turn_off
    entity_id: group.indoor_lights